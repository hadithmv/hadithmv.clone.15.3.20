<!DOCTYPE html>
<html>
  <head>
    <title>ހަތަރު ގަވާއިދު</title>
    <link
      rel="stylesheet"
      href="../css/ALL-COMB.min.css"
      media="print"
      onload="this.media='all'"
    />
    <script src="../js/ALL-COMB.min.js"></script>
    <style></style>
  </head>
  <body>
    <table id="tableID" class="cards" width="100%"></table>

    <button
      id="toggleFiliButton"
      class="customButtons"
      onclick="toggleTashkeel()"
    >
      &nbsp; ފިލިތައް ފޮރުވާ &nbsp;
    </button>
    <script>
      function removeThashkeel(data) {
        return data.replace(/[َ|ً|ُ|ٌ|ِ|ٍ|ْ|ّ|~|⁽|⁾|¹²³⁴⁵⁶⁷⁸⁹⁰]/g, "");
      }
    </script>

    <script src="../js/ALL-COMB.min.js"></script>

    <script type="text/javascript">
      // Declare global variables
      let tashkeelRemoved = false;
      let originalData = [];

      /**
       * Removes tashkeel characters from the given string
       * @param {string} data - The input string
       * @return {string} The string with tashkeel characters removed
       */
      function removeThashkeel(data) {
        return data.replace(/[َ|ً|ُ|ٌ|ِ|ٍ|ْ|ّ|~|⁽|⁾|¹²³⁴⁵⁶⁷⁸⁹⁰]/g, "");
      }

      /**
       * Toggles the visibility of tashkeel characters in the DataTable
       */
      function toggleTashkeel() {
        tashkeelRemoved = !tashkeelRemoved;

        if (tashkeelRemoved) {
          // Remove tashkeel from each cell that contains a string
          const newData = originalData.map((row) =>
            row.map((cell) =>
              typeof cell === "string" ? removeThashkeel(cell) : cell
            )
          );
          // Update the table with the new data
          table.clear().rows.add(newData).draw();
          // Update button text
          document.getElementById("toggleFiliButton").textContent =
            " ފިލިތައް ދައްކާ ";
        } else {
          // Restore original data with tashkeel
          table.clear().rows.add(originalData).draw();
          // Update button text
          document.getElementById("toggleFiliButton").textContent =
            " ފިލިތައް ފޮރުވާ ";
        }

        // Scroll to the top of the page
        scrollUpTop();
      }

      /**
       * Scrolls the window to the top of the page
       */
      function scrollUpTop() {
        window.scrollTo(0, 0);
      }

      //
      //
      //

      // Initialize DataTable
      table = new DataTable("#tableID", {
        ...DTconfig, // Spread your existing DataTable configuration
        ajax: {
          url: `../js/json/qawaidulArbau.json`,
          dataSrc: function (json) {
            // Store the original data when it's first loaded, needed for thashkeel fili removal
            originalData = json;
            return json;
          },
          dataType: "json",
          cache: true, // Enable caching for better performance
        },
        columns: [
          { title: "#" },
          { title: "ބާބު އަރަބިން" },
          { title: "ބާބު ދިވެހިން" },
          { title: "އަރަބި ލިޔުން" },
          { title: "ދިވެހި ލިޔުން" },
          { title: "ތަޚްރީޖު" },
        ],
      });
    </script>
  </body>
</html>
