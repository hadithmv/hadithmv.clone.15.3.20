<!DOCTYPE html>
<html lang="dv" translate="no">
  <head>
    <!-- CHANGE !!! -->
    <title>القواعد الأربع – ހަތަރު ގަވާއިދު</title>
    <meta
      name="description"
      content="The Maldivian Platform for Translations of the Sunnah | ސުންނަތުގެ ތަރުޖަމާ މަންސަ"
    />
    <meta
      name="keywords"
      content="hadithmv,hadith mv, hadeeth mv,dhivehi,hadith,ޙަދީޘްއެމްވީ,ޙަދީޘް އެމްވީ"
    />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta itemprop="name" content="Hadithmv" />
    <meta itemprop="description" content="ޙަދީޘްއެމްވީ" />
    <meta
      itemprop="image"
      content="https://hadithmv.github.io/img/logo/NewLogo7/hadithmv-logo-7.0-whiteBack-512px.png"
    />
    <meta property="og:title" content="Hadithmv" />
    <meta property="og:type" content="website" />
    <meta
      property="og:image"
      content="https://hadithmv.github.io/img/logo/NewLogo7/hadithmv-logo-7.0-whiteBack-512px.png"
    />
    <link rel="icon" href="../img/logo/logo.svg" type="image/svg+xml" />
    <meta name="theme-color" content="#29434e" />
    <link
      rel="stylesheet"
      href="../css/ALL-COMB.min.css"
      media="print"
      onload="this.media='all'"
    />
    <script src="../js/ALL-COMB.min.js"></script>
    <style>
      .q-navigation-container {
        display: flex;
        justify-content: center;
        margin-bottom: 10px;
        font-size: 20px;
        direction: rtl;
      }

      .q-nav-box {
        display: flex;
        align-items: center;
        margin: 0 10px;
        position: relative;
      }

      .q-nav-label {
        margin-left: 5px;
      }

      .q-nav-value {
        border: 1px solid #ccc;
        cursor: pointer;
        min-width: 50px;
        text-align: center;
      }

      .q-nav-value#surahValue {
        min-width: 110px;
      }

      .q-nav-arrow {
        cursor: pointer;
        user-select: none;
        padding: 0 5px;
      }

      .q-dropdown {
        position: absolute;
        top: 100%;
        left: 0;
        background-color: white;
        border: 1px solid #ccc;
        max-height: 80vh;
        overflow-y: auto;
        display: none;
        z-index: 1000;
        width: 100%;
      }

      .q-dropdown-item {
        padding: 5px 10px;
        cursor: pointer;
      }

      .q-dropdown-item:hover {
        background-color: #f0f0f0;
      }

      .q-dropdown-search {
        width: calc(100% - 10px);
        margin: 5px;
        padding: 5px;
        box-sizing: border-box;
        font-family: inherit;
        font-size: 18px;
      }

      /* Styling for highlighted q-dropdown item */
      .q-dropdown-item.highlighted {
        background-color: #e0e0e0;
      }

      /* Responsive styles for mobile devices */
      @media (max-width: 599px) {
        .q-navigation-container {
          font-size: 18px;
          justify-content: space-evenly;
        }

        .q-nav-box {
          margin: 0px;
        }

        .q-nav-label {
          display: none;
        }

        .q-nav-value {
          font-size: 18px;
        }
      }
    </style>
  </head>
  <body>
    <div id="navbar-container"></div>
    <div class="dtWrapper">
      <div class="q-navigation-container">
        <div class="q-nav-box">
          <span class="q-nav-label">ސޫރަތް:</span>
          <span class="q-nav-arrow" data-type="surah" data-direction="prev"
            >▶</span
          >
          <div class="q-nav-value" id="surahValue">1</div>
          <span class="q-nav-arrow" data-type="surah" data-direction="next"
            >◀</span
          >
          <div class="q-dropdown" id="surahDropdown"></div>
        </div>
        <div class="q-nav-box">
          <span class="q-nav-label">އާޔަތް:</span>
          <span class="q-nav-arrow" data-type="ayah" data-direction="prev"
            >▶</span
          >
          <div class="q-nav-value" id="ayahValue">1</div>
          <span class="q-nav-arrow" data-type="ayah" data-direction="next"
            >◀</span
          >
          <div class="q-dropdown" id="ayahDropdown"></div>
        </div>
        <div class="q-nav-box">
          <span class="q-nav-label">ޖުޒް:</span>
          <span class="q-nav-arrow" data-type="juz" data-direction="prev"
            >▶</span
          >
          <div class="q-nav-value" id="juzValue">1</div>
          <span class="q-nav-arrow" data-type="juz" data-direction="next"
            >◀</span
          >
          <div class="q-dropdown" id="juzDropdown"></div>
        </div>
      </div>
      <table id="tableID" class="cards" width="100%"></table>
      <div id="translationSelector" class="rtlText rightAlignedText"></div>

      <div class="hmvSection">
        <div class="centerAlignedText">
          <button
            id="copyPageLink"
            class="customButtons"
            onclick="copyURLToClipButton();"
          >
            &nbsp; ސަފުހާގެ ލިންކު ކޮޕީކުރޭ &nbsp;
          </button>
          <button
            id="toggleFiliButton"
            class="customButtons"
            onclick="toggleFili();filiString();scrollUpTop()"
          >
            &nbsp; ފިލިތައް ފޮރުވާ &nbsp;
          </button>

          <script>
            function toggleFili() {
              var isVisible = $(".dataTable").DataTable().column(3).visible();
              $(".dataTable").DataTable().column(3).visible(!isVisible);

              var isVisible = $(".dataTable").DataTable().column(4).visible();
              $(".dataTable").DataTable().column(4).visible(!isVisible);
            }
          </script>

          <hr />
          <p>
            اسم الكتاب: ‌‌القواعد الأربع - لمحمد بن عبد الوهاب بن سليمان التميمي
            النجدي (ت ١٢٠٦ هـ)
            <br />
            تحقيق: عبد المحسن القاسم | متون طالب العلم - المستوى الأول |
            السادسة، ١٤٣٩ هـ - ٢٠١٨ م.
          </p>

          <p>
            ފޮތުގެ ނަން: ހަތަރު ގަވާއިދު | ލިޔުނީ: މުޙައްމަދު ބިން ޢަބްދުލް
            ވައްހާބް ބިން ސުލައިމާން އައްތަމީމީ އައްނަޖްދީ (1206 ހ.)
            <br />
            ތަހްގީގުކުރީ: ޢަބްދުލް މުޙްސިން އަލްގާސިމް | މުތޫން ޠާލިބިލް ޢިލްމި
            (އިލްމު އުނގެނޭ ދަރިވަރުގެ މަތުނުތައް) - ފުރަތަމަ މުސްތަވާ | ހަވަނަ
            ޗާޕު 1439 ހ. - 2018 މ.
          </p>

          <p>
            އަރަބި
            <a href="https://shamela.ws/book/570/22" target="_blank">އީ-ފޮތް</a>
            |
            <a
              href="https://archive.org/details/mutoon-talibul-ilm-01-alqasim/page/n29"
              target="_blank"
              >ޕީޑީއެފް</a
            >
          </p>
        </div>
        <!-- <div class="centerAlignedText"> END -->

        <hr />

        <p>
          އަބޫ އަނަސްގެ ދިވެހި ތަރުޖަމާގެ
          <a
            href="https://archive.org/details/qawaidulArbau-abu-anas"
            target="_blank"
            >ޕީޑީއެފް</a
          >
        </p>

        <p>
          އަބޫ ޢަބްދު ﷲ ޢަބްދުއްރަޙީމްގެ ދިވެހި ތަރުޖަމާގެ
          <a
            href="https://archive.org/details/qawaidulArbau-abdurraheem-mohamed"
            target="_blank"
            >ޕީޑީއެފް</a
          >
        </p>

        <p>
          މުޙައްމަދު ޝާފިޢުގެ ދިވެހި ތަރުޖަމާގެ
          <a
            href="https://shafiu.mv/tag/%de%80%de%a6%de%8c%de%a6%de%83%de%aa-%de%a4%de%a6%de%88%de%a7%de%a2%de%a8%de%8b%de%aa/"
            target="_blank"
            >އީ-ފޮތް</a
          >
          |
          <a
            href="https://archive.org/details/qawaidulArbau-mohamed-shafiu"
            target="_blank"
            >ޕީޑީއެފް</a
          >
        </p>

        <p>
          އަބޫ ޢުބައިދާ އަލްމަރަދުވީގެ ދިވެހި ތަރުޖަމާގެ
          <a
            href="https://dawahsalafiyyah-maldives.blogspot.com/2009/01/blog-post.html"
            target="_blank"
            >އީ-ފޮތް</a
          >
        </p>

        <p>
          އިނގިރޭސި ތަރުޖަމާގެ ޕީޑީއެފް
          <a
            href="https://archive.org/details/qawaidul-arbau-english"
            target="_blank"
            >1</a
          >
          |
          <a
            href="https://archive.org/details/qawaidul-arbau-english-sp"
            target="_blank"
            >2</a
          >
          |
          <a
            href="https://archive.org/details/qawaidul-arbau-english-aq"
            target="_blank"
            >3</a
          >
        </p>

        <p>
          އިނގިރޭސި ޝަރަހައިގެ ޕީޑީއެފް
          <a
            href="https://archive.org/details/sharh-usoolu-thalaatha-wa-qawaidul-arbau-wa-nawaqidul-islam-sarhan-en"
            target="_blank"
            >1</a
          >
          |
          <a
            href="https://archive.org/details/sharh-qawaidul-arbau-fawzan-english"
            target="_blank"
            >2</a
          >
          |
          <a
            href="https://archive.org/details/sharh-qawaidul-arbau-baz-english"
            target="_blank"
            >3</a
          >
          |
          <a
            href="https://archive.org/details/sharh-qawaidul-arbau-english-fawzan-rajihi-zaid-rayyis"
            target="_blank"
            >4</a
          >
        </p>

        <hr />

        <p>
          شرح القواعد الأربع - لصالح بن فوزان الفوزان
          <br />
          އަރަބި
          <a href="https://ketabonline.com/ar/books/774" target="_blank"
            >އީ-ފޮތް</a
          >
          |
          <a
            href="https://archive.org/details/sharh-qawaidul-arbau-fawzan"
            target="_blank"
            >ޕީޑީއެފް</a
          >
        </p>

        <p>
          شرح القواعد الأربع - لصالح بن عبد العزيز آل الشيخ
          <br />
          މި ސަފުހައިގައިވާ ޝަރަހަ 2: ޞާލިޙު އާލްޝައިޚުގެ ޝަރަހަ
          <br />
          އަރަބި
          <a href="https://ketabonline.com/ar/books/14678" target="_blank"
            >އީ-ފޮތް</a
          >
          |
          <a
            href="https://archive.org/details/sharh-qawaidul-arbau-salih-aalsheikh"
            target="_blank"
            >ޕީޑީއެފް</a
          >
        </p>

        <p>
          شرح القواعد الأربع - لهيثم سرحان
          <a
            href="https://archive.org/details/sharh-usoolu-thalaatha-wa-qawaidul-arbau-wa-nawaqidul-islam-sarhan/page/n55"
            target="_blank"
            >ޕީޑީއެފް</a
          >
        </p>

        <p>
          شرح القواعد الأربع - لعبد المحسن بن محمد القاسم
          <a
            href="https://archive.org/details/sharh-qawaidul-arbau-alqasim"
            target="_blank"
            >ޕީޑީއެފް</a
          >
        </p>

        <p>
          شرح القواعد الأربع - لعبد العزيز ابن باز
          <a
            href="https://archive.org/details/sharh-qawaidul-arbau-bin-baz"
            target="_blank"
            >ޕީޑީއެފް</a
          >
        </p>

        <p>
          شرح قواعد الأربع - لصالح سندي
          <a
            href="https://archive.org/details/sharh-qawaidul-arbau-sindi"
            target="_blank"
            >ޕީޑީއެފް</a
          >
        </p>

        <p>
          شرح قواعد الأربع - لصالح السحيمي
          <a
            href="https://archive.org/details/sharh-qawaidul-arbau-suhaimy"
            target="_blank"
            >ޕީޑީއެފް</a
          >
        </p>

        <p>
          شرح القواعد الأربع - لعبيد الجابري
          <a
            href="https://archive.org/details/sharh-qawaidul-arbau-jabiri"
            target="_blank"
            >ޕީޑީއެފް</a
          >
        </p>

        <p>
          شرح القواعد الأربع - لعبد الرزاق البدر
          <a
            href="https://archive.org/details/sharh-qawaidul-arbau-badr"
            target="_blank"
            >ޕީޑީއެފް</a
          >
        </p>

        <p>
          شرح القواعد الأربع - لصالح العصيمي
          <a
            href="https://archive.org/details/sharh-qawaidul-arbau-usaimy"
            target="_blank"
            >ޕީޑީއެފް</a
          >
        </p>

        <p>
          شرح القواعد الأربع - لأحمد بن عمر بازمول
          <a
            href="https://archive.org/details/sharh-qawaidul-arbau-bazmul"
            target="_blank"
            >ޕީޑީއެފް</a
          >
        </p>

        <hr />

        ތަރުޖަމާގެ
        <p>النسخ المعتمدة في تحقيق هذا المثن:</p>
        <p>
          - نسخة خطية بمركز الملك فيصل - السعودية -، برقم (٥٢٥٨)، تاريخ نسخها:
          ۱۳۰۷ هـ، ورمزت لها بـ (أ).
        </p>
        <p>
          - نسخة خطية بمركز الملك فيصل - السعودية -، برقم (٥٢٦٥)، تاريخ نسخها:
          ۱۳۳۸هـ، ورمزت لها بـ (ب).
        </p>
        <p>
          - نسخة خطية بالمكتبة المحمودية، بمكتبة الملك عبد العزيز - السعودية -،
          برقم (١٤٣٧)، ورمزت لها بـ (ج).
        </p>
        <p>
          - نسخة خطية بالمكتبة المحمودية، بمكتبة الملك عبد العزيز - السعودية -،
          برقم (۱۹۲۱)، ورمزت لها بـ (د).
        </p>
        <p>
          - نسخة خطية بمكتبة الشيخ / عبد الرحمن بن ناصر السعدي بالقصيم -
          السعودية -، ورمزت لها بـ (هـ).
        </p>
      </div>
    </div>
    <script type="text/javascript">
      // Configuration for the DataTable

      let currentSurah = 1;
      let currentAyah = 1;
      let currentJuz = 1;
      const maxSurah = 114;
      const maxJuz = 30;
      let ayahCounts = {};

      // Initialize dropdowns after table initialization
      function initializeNavigationBoxes() {
        initializeQDropdown("surah", 1, maxSurah);
        initializeQDropdown("juz", 1, maxJuz);
        updateAyahDropdown();

        // Event listeners for navigation boxes
        $(".q-nav-value").on("click", function () {
          var type = $(this).attr("id").replace("Value", "");
          QtoggleDropdown(type);
        });

        $(".q-nav-arrow").on("click", function () {
          var type = $(this).data("type");
          var direction = $(this).data("direction");
          QnavigateArrow(type, direction);
        });

        $(document).on("click", function (event) {
          if (!$(event.target).closest(".q-nav-box").length) {
            $(".q-dropdown").hide();
          }
        });
      }

      // Add this function to your existing code
      function initializeQDropdown(type, min, max) {
        var dropdown = $("#" + type + "Dropdown");
        dropdown.empty();
        dropdown.append(
          '<input type="text" class="q-dropdown-search" placeholder="ލިޔޭ ނޫނީ ތިރިއަށް ފިތާ">'
        );
        for (var i = min; i <= max; i++) {
          var displayText = i;
          if (type === "surah" && surahNames[i]) {
            displayText = i + " " + surahNames[i];
          }
          dropdown.append(
            '<div class="q-dropdown-item" data-value="' +
              i +
              '">' +
              displayText +
              "</div>"
          );
        }

        // Event listener for dropdown item clicks
        dropdown.on("click", ".q-dropdown-item", function () {
          var value = $(this).data("value");
          updateQValue(type, value);
          dropdown.hide();
        });

        // Event listener for search input
        dropdown.find(".q-dropdown-search").on("input", function () {
          var searchValue = removeDiacritics($(this).val().toLowerCase());
          dropdown.find(".q-dropdown-item").each(function () {
            var itemText = removeDiacritics($(this).text().toLowerCase());
            $(this).toggle(itemText.includes(searchValue));
          });
        });
      }

      function updateAyahDropdown() {
        var maxAyah = ayahCounts[currentSurah] || 1;
        initializeQDropdown("ayah", 1, maxAyah);
        $("#ayahValue").text("1");
      }

      function QtoggleDropdown(type) {
        var dropdown = $("#" + type + "Dropdown");
        $(".q-dropdown").not(dropdown).hide();
        dropdown.toggle();

        if (dropdown.is(":visible")) {
          var currentValue = parseInt($("#" + type + "Value").text());
          var item = dropdown.find(
            '.q-dropdown-item[data-value="' + currentValue + '"]'
          );
          if (item.length) {
            item.get(0).scrollIntoView({ block: "center" });
          }
          dropdown.find(".q-dropdown-search").val("").focus();
        }
      }

      function updateQValue(type, value) {
        value = parseInt(value);
        if (type === "surah" && surahNames[value]) {
          $("#" + type + "Value").text(value + " " + surahNames[value]);
        } else {
          $("#" + type + "Value").text(value);
        }
        if (type === "surah") {
          currentSurah = value;
          currentAyah = 1;
          updateAyahDropdown();
        } else if (type === "ayah") {
          currentAyah = value;
        } else if (type === "juz") {
          currentJuz = value;
        }
        navigateToVerse();
      }

      function QnavigateArrow(type, direction) {
        var current,
          max,
          min = 1;
        if (type === "surah") {
          current = currentSurah;
          max = maxSurah;
        } else if (type === "ayah") {
          current = currentAyah;
          max = ayahCounts[currentSurah] || 1;
        } else if (type === "juz") {
          current = currentJuz;
          max = maxJuz;
        }

        if (direction === "prev") {
          current--;
          if (current < min) {
            if (type === "ayah") {
              currentSurah--;
              if (currentSurah < 1) currentSurah = maxSurah;
              updateAyahDropdown();
              current = ayahCounts[currentSurah] || 1;
            } else {
              current = max;
            }
          }
        } else {
          current++;
          if (current > max) {
            if (type === "ayah") {
              currentSurah++;
              if (currentSurah > maxSurah) currentSurah = 1;
              updateAyahDropdown();
              current = 1;
            } else {
              current = min;
            }
          }
        }

        updateQValue(type, current);
      }

      function navigateToVerse() {
        var targetRow = table
          .rows()
          .indexes()
          .filter(function (value, index) {
            var rowData = table.row(value).data();
            return (
              parseInt(rowData[1]) == currentSurah &&
              parseInt(rowData[2]) == currentAyah
            );
          });

        if (targetRow.length > 0) {
          // Get the page number of the target row
          var pageInfo = table.page.info();
          var targetPage = Math.floor(targetRow[0] / pageInfo.length);

          // Go to the page containing the target row
          table.page(targetPage).draw(false);

          // Scroll to the target row within the page
          var rowNode = table.row(targetRow[0]).node();
          if (rowNode) {
            rowNode.scrollIntoView({ behavior: "smooth", block: "center" });
          }

          // Update navigation boxes with the current values
          updateAllQValues(table.row(targetRow[0]).data());
        }
      }

      function updateAllQValues(rowData) {
        currentJuz = parseInt(rowData[0]);
        currentSurah = parseInt(rowData[1]);
        currentAyah = parseInt(rowData[2]);
        $("#juzValue").text(currentJuz);
        $("#surahValue").text(currentSurah + " " + surahNames[currentSurah]);
        $("#ayahValue").text(currentAyah);
      }

      // Helper function to remove diacritics
      function removeDiacritics(text) {
        return text.replace(/[َُِّْٰۡۚٓـًٌٍّٔ]/g, "");
      }

      // Global variables
      //let table;
      let additionalColumns = []; // Tracks which additional translations are currently visible

      const baseJsonUrl = "../js/json/"; // Base URL for all JSON files

      // Base columns that are always present in the table
      const baseColumns = [
        { data: "0", title: "Juz" },
        { data: "1", title: "Surah" },
        { data: "2", title: "AyahNo" },
        { data: "3", title: "Basmalah" },
        { data: "4", title: "Ayah" },
        { data: "5", title: "AyahUthmani" },
      ];

      // Configuration for additional translations that can be toggled
      // name: filename without extension
      // column: which column index in the JSON contains the translation text
      // title: display name for the translation
      const additionalJsons = [
        { name: "quranHadithmv", column: 0, title: "ޙަދީޘްއެމްވީ ތަރުޖަމާ" },
        { name: "quranRasmee", column: 0, title: "ރަސްމީ ތަރުޖަމާ" },
        { name: "quranBakurube", column: 1, title: "ބަކުރުބެ ތަރުޖަމާ" },
        { name: "quranJaufar", column: 0, title: "ޖަޢުފަރު ތަފްސީރު" },
        { name: "quranSoabuni", column: 1, title: "ޞ ތަފްސީރު" },
        { name: "quranMukhtasar", column: 0, title: "މުޚްތަޞަރު ތަފްސީރު" },
        { name: "quranMuyassar", column: 0, title: "މުޔައްސަރު ތަފްސީރު" },
      ];

      // The translation that will be shown by default when the page loads
      const defaultAdditionalJson = "quranHadithmv";

      /**
       * Creates all column definitions for the DataTable, including both base columns
       * and additional translation columns (which start hidden)
       * @returns {Array} Array of column definition objects for DataTables
       */
      function getAllColumnDefinitions() {
        // Create column definitions for additional translations
        const additionalColumnDefs = additionalJsons.flatMap((json) => [
          // Name column - shows the translation name in bold

          {
            title: `<strong>${json.title}</strong>`,
            data: null,
            name: `${json.title}:name`,
            visible: false,
            render: function () {
              return `<strong>${json.title}</strong>`;
            },
          },

          // Data column - shows the actual translation text
          {
            title: json.title,
            data: null,
            name: json.title,
            visible: false,
            render: function (data, type, row) {
              if (row[json.title]) {
                return row[json.title][json.column];
              }
              return "Loading...";
            },
          },
        ]);

        // Combine base columns with additional columns
        return [...baseColumns, ...additionalColumnDefs];
      }

      /**
       * Initializes the DataTable with base data and sets up the default translation
       */
      function initializeTable() {
        // Clear any existing additional columns to ensure fresh start
        additionalColumns = [];

        // Initialize the DataTable
        table = new DataTable("#tableID", {
          ...DTconfig,
          ajax: {
            url: `${baseJsonUrl}quranJuz-surah-ayahNo-basmalah-ayah-ayahUthmani.json`,
            dataSrc: "",
          },
          columns: getAllColumnDefinitions(),
          initComplete: function () {
            // Hide all additional columns initially
            additionalJsons.forEach((json, index) => {
              const baseColumnsLength = baseColumns.length;
              const columnIndex = baseColumnsLength + index * 2;
              table.column(columnIndex).visible(false);
              table.column(columnIndex + 1).visible(false);
            });

            // Then toggle/Show only the default translation
            toggleTranslation(defaultAdditionalJson);
            updateTranslationSelector();
            //
            // Initialize navigation boxes
            initializeNavigationBoxes();

            // Populate ayahCounts object
            table.rows().every(function (rowIdx, tableLoop, rowLoop) {
              var data = this.data();
              var surah = parseInt(data[1]);
              var ayah = parseInt(data[2]);
              ayahCounts[surah] = Math.max(ayahCounts[surah] || 0, ayah);
            });

            // Update navigation boxes with initial values
            updateAllQValues(table.row(0).data());
          },
        });
      }

      /**
       * Toggles visibility of a translation column and loads its data if needed
       * @param {string} jsonName - The name of the translation to toggle
       */
      function toggleTranslation(jsonName) {
        const index = additionalColumns.indexOf(jsonName);
        const jsonInfo = additionalJsons.find((j) => j.name === jsonName);
        const baseColumnsLength = baseColumns.length;
        const jsonIndex = additionalJsons.findIndex((j) => j.name === jsonName);
        // Calculate column indices (each translation has two columns - name and data)
        const columnIndex = baseColumnsLength + jsonIndex * 2;

        if (index > -1) {
          // Remove column // If translation is currently shown, hide it
          additionalColumns.splice(index, 1);
          table.column(columnIndex).visible(false);
          table.column(columnIndex + 1).visible(false);
        } else {
          // Add column // If translation is currently hidden, show it
          additionalColumns.push(jsonName);

          //Load the translation JSON data
          $.ajax({
            url: `${baseJsonUrl}${jsonName}.json`,
            dataType: "json",
            success: function (data) {
              // Get current table data
              const currentData = table.data().toArray();

              // Merge new translation data with existing data
              currentData.forEach((row, idx) => {
                row[jsonInfo.title] = data[idx];
              });

              // Update the table with merged data
              table.clear();
              table.rows.add(currentData);

              // Show the translation columns
              table.column(columnIndex).visible(true);
              table.column(columnIndex + 1).visible(true);

              // Redraw the table to show changes
              table.draw();

              //console.log("Loaded data for " + jsonName + ":", data);
              //console.log("Current table data:", currentData);
            },
            error: function (xhr, status, error) {
              console.error("Error loading translation:", error);
            },
          });
        }

        // Update the checkbox UI
        updateTranslationSelector();
      }

      /**
       * Shows all available translations
       */ function showAllTranslations() {
        additionalJsons.forEach((json) => {
          if (!additionalColumns.includes(json.name)) {
            toggleTranslation(json.name);
          }
        });
      }

      /**
       * Resets to show only the default translation
       */

      function resetTranslations() {
        const currentColumns = [...additionalColumns];
        // Hide all non-default translations
        currentColumns.forEach((jsonName) => {
          if (jsonName !== defaultAdditionalJson) {
            toggleTranslation(jsonName);
          }
        });
        // Ensure default translation is shown
        if (!additionalColumns.includes(defaultAdditionalJson)) {
          toggleTranslation(defaultAdditionalJson);
        }
      }

      /**
       * Updates the translation selector UI with checkboxes and buttons
       */
      function updateTranslationSelector() {
        const selectorContainer = document.getElementById(
          "translationSelector"
        );
        selectorContainer.innerHTML = "<h3>އިތުރު ތަރުޖަމާ / ތަފްސީރު:</h3>";

        // Create and add the "Show All" button
        const showAllButton = document.createElement("button");
        showAllButton.textContent = "Show All";
        showAllButton.addEventListener("click", showAllTranslations);
        selectorContainer.appendChild(showAllButton);

        // Create and add the "Reset" button
        const resetButton = document.createElement("button");
        resetButton.textContent = "Reset";
        resetButton.addEventListener("click", resetTranslations);
        selectorContainer.appendChild(resetButton);

        // Add some spacing
        //selectorContainer.appendChild(document.createElement("br"));
        selectorContainer.appendChild(document.createElement("br"));

        // Create container for checkboxes with styling
        const checkboxesContainer = document.createElement("div");
        checkboxesContainer.style.cssText = `
    display: flex;
    flex-direction: column;
    gap: 10px;
  `;
        selectorContainer.appendChild(checkboxesContainer);

        // Create checkboxes for each translation
        additionalJsons.forEach((json) => {
          const checkboxContainer = document.createElement("div");
          checkboxContainer.style.display = "flex";
          checkboxContainer.style.alignItems = "center";
          checkboxContainer.style.gap = "8px";

          // Create checkbox
          const checkbox = document.createElement("input");
          checkbox.type = "checkbox";
          checkbox.id = json.name;
          checkbox.checked = additionalColumns.includes(json.name);
          checkbox.addEventListener("change", () =>
            toggleTranslation(json.name)
          );

          // Create label
          const label = document.createElement("label");
          label.htmlFor = json.name;
          label.textContent = json.title;

          // Add checkbox and label to container
          checkboxContainer.appendChild(checkbox);
          checkboxContainer.appendChild(label);
          checkboxesContainer.appendChild(checkboxContainer);
        });
      }

      // Initialize the table when the page loads
      document.addEventListener("DOMContentLoaded", initializeTable);
    </script>
    <!-- Google Tag Manager -->
    <script>
      (function (w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({ "gtm.start": new Date().getTime(), event: "gtm.js" });
        var f = d.getElementsByTagName(s)[0],
          j = d.createElement(s),
          dl = l != "dataLayer" ? "&l=" + l : "";
        j.async = true;
        j.src = "https://www.googletagmanager.com/gtm.js?id=" + i + dl;
        f.parentNode.insertBefore(j, f);
      })(window, document, "script", "dataLayer", "GTM-TRR5NPBL");
    </script>
    <!-- End Google Tag Manager -->
    <!-- Google Tag Manager (noscript) -->
    <noscript
      ><iframe
        src="https://www.googletagmanager.com/ns.html?id=GTM-TRR5NPBL"
        height="0"
        width="0"
        style="display: none; visibility: hidden"
      ></iframe
    ></noscript>
    <!-- End Google Tag Manager (noscript) -->
  </body>
</html>
