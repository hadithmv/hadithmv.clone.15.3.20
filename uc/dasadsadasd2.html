<!doctype html>
<html>
  <head>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <link
      href="https://nightly.datatables.net/css/dataTables.dataTables.css"
      rel="stylesheet"
      type="text/css"
    />
    <script src="https://nightly.datatables.net/js/dataTables.js"></script>
    <!-- -->
    <link
      href="https://cdn.datatables.net/plug-ins/2.1.2/features/inputPaging/dist/dataTables.inputPaging.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <script src="https://cdn.datatables.net/plug-ins/2.1.2/features/inputPaging/dist/dataTables.inputPaging.min.js"></script>
    <!-- -->
    <link
      href="https://cdn.datatables.net/buttons/3.1.0/css/buttons.dataTables.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.datatables.net/buttons/3.1.0/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/3.1.0/js/buttons.colVis.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/3.1.0/js/buttons.html5.min.js"></script>
    <!-- -->
    <link
      href="https://cdn.datatables.net/searchbuilder/1.7.1/css/searchBuilder.dataTables.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.datatables.net/searchbuilder/1.7.1/js/dataTables.searchBuilder.min.js"></script>
    <!-- searchpanes requires select too -->
    <link
      href="https://cdn.datatables.net/searchpanes/2.3.1/css/searchPanes.dataTables.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.datatables.net/searchpanes/2.3.1/js/dataTables.searchPanes.min.js"></script>
    <link
      href="https://cdn.datatables.net/select/2.0.3/css/select.dataTables.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.datatables.net/select/2.0.3/js/dataTables.select.min.js"></script>
    <!-- -->
    <link
      href="https://cdn.datatables.net/keytable/2.12.1/css/keyTable.dataTables.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.datatables.net/keytable/2.12.1/js/dataTables.keyTable.min.js"></script>
    <!-- -->
    <script src="https://cdn.datatables.net/plug-ins/2.1.3/api/row().show().min.js"></script>
    <!-- -->

    <!--
    <script src="arrays.js"></script> -->
    <script>
      var data = [
        ["Tiger Nixon", "System Architect", "Edinburgh"],
        ["Garrett Winters", "Accountant", "Tokyo"],
        ["Ashton Cox", "Junior Technical Author", "San Francisco"],
      ];
    </script>
    <!-- -->
  </head>

  <body>
    <table id="example" class="display cards" width="100%"></table>
    <script type="text/javascript">
      /*
        this is my datatables js code

what i want is

by default desktopConfig should be applied under
table = new DataTable("#example", {
        // config goes here

if screen is mobile, it should be mobileConfig applied instead.
resizing the screen should also apply the correct config

also on desktop view, when a page change occurs, should scroll to the top of the page
on mobile view, a page change should scroll to the first row in the table
resizing the screen should also have it work the way its supposed to be

also on desktop view, should focus on the search input when it starts, but no need to do so on resize, and the code would be something like:
$("div.dt-search .dt-input", table.table().container()).focus();

as to be efficient and avoid overloads and crashes, there should be debouncing used for the resize related stuff
*/
      var table;
      var isMobile = window.innerWidth <= 800;
      var touchStartX = null;
      var touchEndX = null;

      var desktopConfig = {
        layout: {
          top: ["buttons", "pageLength"],
          bottom: ["inputPaging", "info"],
        },
      };

      var mobileConfig = {
        layout: {
          top: [
            "inputPaging",
            "search",
            {
              buttons: [
                { extend: "copy" },
                {
                  extend: "collection",
                  background: false,
                  buttons: [
                    { extend: "colvis", background: false },
                    { extend: "searchBuilder" },
                    { extend: "searchPanes" },
                  ],
                },
                { extend: "pageLength", background: false },
              ],
            },
          ],
          bottom: ["inputPaging", "info"],
        },
      };

      function initializeDataTable() {
        var config = isMobile ? mobileConfig : desktopConfig;

        table = new DataTable("#example", {
          ...config,
          columns: [null, null, null],
          data: data,
          drawCallback: function () {
            if (!isMobile) {
              window.scrollTo(0, 0);
            } else {
              var firstRow = this.api().row(0).node();
              if (firstRow) {
                firstRow.scrollIntoView();
              }
            }
          },
        });

        if (!isMobile) {
          $("div.dt-search .dt-input", table.table().container()).focus();
        }

        if (isMobile) {
          enableSwipe();
        } else {
          disableSwipe();
        }
      }

      function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
          const later = () => {
            clearTimeout(timeout);
            func(...args);
          };
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);
        };
      }

      function handleResize() {
        var newIsMobile = window.innerWidth <= 800;
        if (newIsMobile !== isMobile) {
          isMobile = newIsMobile;
          table.destroy();
          initializeDataTable();
        }
      }

      function enableSwipe() {
        const tableElement = document.querySelector("#example");
        tableElement.addEventListener("touchstart", handleTouchStart, false);
        tableElement.addEventListener("touchend", handleTouchEnd, false);
      }

      function disableSwipe() {
        const tableElement = document.querySelector("#example");
        tableElement.removeEventListener("touchstart", handleTouchStart, false);
        tableElement.removeEventListener("touchend", handleTouchEnd, false);
      }

      function handleTouchStart(event) {
        touchStartX = event.changedTouches[0].screenX;
      }

      function handleTouchEnd(event) {
        touchEndX = event.changedTouches[0].screenX;
        handleSwipeGesture();
      }

      function handleSwipeGesture() {
        if (touchEndX < touchStartX) {
          table.page("next").draw("page");
        }
        if (touchEndX > touchStartX) {
          table.page("previous").draw("page");
        }
      }

      window.addEventListener("resize", debounce(handleResize, 250));

      initializeDataTable();
    </script>
  </body>
</html>
